---
title: "R Notebook"
output: html_notebook
---
```{r}
library(tidyverse)
library(modelr)
```

```{r}
height <- c(176, 164, 181, 168, 195, 185, 166, 180, 188, 174)
weight <- c(82, 65, 85, 76, 90, 92, 68, 83, 94, 74 )
sample <- tibble(
  weight,
  height
)
```

```{r}
model <- lm(height ~ weight,
            data = sample)
```
```{r}
summary(model)
```

```{r}
library(broom)
```
```{r}
model %>% 
  tidy()
```
```{r}
glance_output <- model %>% 
  glance() %>%
  janitor::clean_names()
```
```{r}
tidy_output <- model %>% 
  tidy() %>% 
  janitor::clean_names()
```
```{r}
glance_output$r_squared
```
>r_squared: goodness of fit
            proportion of variation in height can be explained by weight
            higher the value means teh better the line (model) fits the data 
            
```{r}
sample %>% 
  summarise(r = cor(height, weight)) %>% 
  mutate(rsqure = r^2)
```
###diagnostic plots
```{r}
library(ggfortify)
autoplot(model)
```
```{r}
sample %>% 
  add_residuals(model) %>% 
  ggplot(aes(x = resid))+
  geom_histogram(binwidth = 2)
```

#task
```{r}
distr_1 <- read_csv("data/distribution_1.csv")
distr_2 <- read_csv("data/distribution_2.csv")
```
```{r}
model <- lm(y ~ x,
            data = distr_1)
autoplot(model)
```

```{r}
distr_1 %>% 
  add_predictions(model) %>% 
  ggplot(aes(x = x))+
  geom_point(aes(y = y))+
  geom_line(aes(y = pred), col = "red")
```
linear model doesn't fit data , there is a curvature of the plot

```{r}
model <- lm(y ~ x,
            data = distr_2)

autoplot(model)

distr_2 %>% 
  add_predictions(model) %>% 
  ggplot(aes(x = x))+
  geom_point(aes(y = y))+
  geom_line(aes(y = pred), col = "red")
```
increase in absolute residuals with higher fitted values, systematic increase

###bootstrapping regression
> enrures sampling distribution to be normal

```{r}
library(infer)
```

```{r}
bootstrap_dist_slope <- distr_2 %>% 
  specify(formula = y ~ x) %>% 
  generate(reps = 10000, type = "bootstrap") %>% 
  calculate(stat = "slope")

slope_ci95 <- bootstrap_dist_slope %>% 
  get_ci(level = 0.95, type = "percentile")
```
```{r}
bootstrap_dist_slope %>% 
  visualise(bins = 30)+
  shade_ci(endpoints = slope_ci95)
```
```{r}
model %>% 
  tidy(conf.int = TRUE, conf.level = 0.95) %>% 
  janitor::clean_names()
```

